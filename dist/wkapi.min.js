!function e(t,r,i){function n(s,a){if(!r[s]){if(!t[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[s]={exports:{}};t[s][0].call(l.exports,function(e){var r=t[s][1][e];return n(r?r:e)},l,l.exports,e,t,r,i)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<i.length;s++)n(i[s]);return n}({1:[function(e,t,r){var i=e("./util/jsonp"),n=function(){function e(e){this._apiKey=e,this.API_BASE="https://www.wanikani.com/api/v1.3/user/"}return e.prototype.getData=function(e,t){return i.jsonp(this.constructUrl(e,t))},e.prototype.constructUrl=function(e,t){var r=this.API_BASE+this._apiKey+"/"+e+"/";return t&&(r+=t+"/"),r},e}();r.Fetcher=n},{"./util/jsonp":2}],2:[function(e,t,r){var i=e("./objectConvert");r.jsonp=function(e){if(!window.Promise)throw"Promise not available. Please apply a polyfill.";var t=function(e,t){var r=document.createElement("script");return r.src=e+(e.indexOf("?")>=0?"&":"?")+"callback="+t,r};return new Promise(function(r,n){var o="jsonp_callback_"+Math.round(1e5*Math.random()),s=t(e,o);s.onerror=n,document.body.appendChild(s),window[o]=function(e){e.error?n(e.error):r(i.convertCase(e)),window[o]=null,delete window[o],document.body.removeChild(s)}})}},{"./objectConvert":3}],3:[function(e,t,r){r.convertCase=function(e){if(!e||"object"!=typeof e)return e;if(e instanceof Array)return e.map(function(e){return r.convertCase(e)});var t={};return Object.keys(e).forEach(function(i){var n=i.replace(/\_(.)/gim,function(e){return e[1].toUpperCase()});t[n]=r.convertCase(e[i])}),t}},{}],4:[function(e,t,r){var i=e("./fetcher"),n=function(){function e(e){if(this._apiKey=e,this._expiryTime=3600,this._levelsPerRequest=25,this._lastCriticalRate=0,this._userInformation={},this._studyQueue={},this._levelProgress={},this._srsDistribution={},this._recentUnlocks={},this._criticalItems={},this._radicals={},this._kanji={},this._storageKeys=["_userInformation","_studyQueue","_levelProgress","_srsDistribution","_recentUnlocks","_criticalItems","_lastCriticalRate","_radicals","_kanji"],32!==e.length||!e.match(/[A-z0-9]{32}/))throw"Invalid API Key. API Key must be 32 alphanumeric characters in length.";this._fetcher=new i.Fetcher(e),window.localStorage&&this._loadLocalStorage()}return e.prototype.getUserInformation=function(){var e=this;return this._isValid(this._userInformation)?Promise.resolve(this._userInformation.data):new Promise(function(t,r){var i=e._fetcher.getData("user-information");i.then(function(r){e._setCacheItem(e._userInformation,r),t(r.userInformation)})["catch"](r)})},e.prototype.getStudyQueue=function(){var e=this;return this._isValid(this._studyQueue)?Promise.resolve(this._studyQueue.data):new Promise(function(t,r){var i=e._fetcher.getData("study-queue");i.then(function(r){e._setCacheItem(e._studyQueue,r),t(r.requestedInformation)})["catch"](r)})},e.prototype.getLevelProgression=function(){var e=this;return this._isValid(this._levelProgress)?Promise.resolve(this._levelProgress.data):new Promise(function(t,r){var i=e._fetcher.getData("level-progression");i.then(function(r){e._setCacheItem(e._levelProgress,r),t(r.requestedInformation)})["catch"](r)})},e.prototype.getSrsDistribution=function(){var e=this;return this._isValid(this._srsDistribution)?Promise.resolve(this._srsDistribution.data):new Promise(function(t,r){var i=e._fetcher.getData("srs-distribution");i.then(function(r){e._setCacheItem(e._srsDistribution,r),t(r.requestedInformation)})["catch"](r)})},e.prototype.getRecentUnlocks=function(e){var t=this;void 0===e&&(e=10);var r=!1;return this._recentUnlocks.data&&(r=this._recentUnlocks.data.length!=e),this._isValid(this._recentUnlocks)&&!r?Promise.resolve(this._recentUnlocks.data):new Promise(function(r,i){var n=t._fetcher.getData("recent-unlocks",e);n.then(function(e){t._setCacheItem(t._recentUnlocks,e),r(e.requestedInformation)})["catch"](i)})},e.prototype.getCriticalItems=function(e){var t=this;void 0===e&&(e=75);var r=this._lastCriticalRate!=e;return this._isValid(this._criticalItems)&&!r?Promise.resolve(this._criticalItems.data):(this._lastCriticalRate=e,new Promise(function(r,i){var n=t._fetcher.getData("critical-items",e);n.then(function(e){t._setCacheItem(t._criticalItems,e),r(e.requestedInformation)})["catch"](i)}))},e.prototype.getRadicals=function(e){var t=this;this._radicals||(this._radicals={});var r=this._parseLevelRequest(e),i=this._findUncachedLevels(this._radicals,r);return 0==i.length?Promise.resolve(this._pickCacheLevels(this._radicals,r)):new Promise(function(e,n){var o=t._fetcher.getData("radicals",i.join(","));o.then(function(i){var n=t._sortToLevels(i.requestedInformation);t._cacheToLevels(t._radicals,n),t._setCacheItem(t._userInformation,i),e(t._pickCacheLevels(t._radicals,r))})})},e.prototype.getKanji=function(e){var t=this;this._kanji||(this._kanji={});var r=this._parseLevelRequest(e),i=this._findUncachedLevels(this._kanji,r);return 0==i.length?Promise.resolve(this._pickCacheLevels(this._kanji,r)):new Promise(function(e,n){for(var o=[];i.length>0;)o.push(t._fetcher.getData("kanji",i.splice(0,25).join(",")));return Promise.all(o).then(function(i){for(var n=[],o=0;o<i.length;o++){var s=i[o];n=n.concat(s.requestedInformation)}var a=t._sortToLevels(n);t._cacheToLevels(t._kanji,a),t._setCacheItem(t._userInformation,i[0]),e(t._pickCacheLevels(t._kanji,r))})})},e.prototype.setExpiry=function(e){this._expiryTime=e},e.prototype.setLevelsPerRequest=function(e){this._levelsPerRequest=e},e.prototype._parseLevelRequest=function(e){var t=this;if("number"==typeof e)return[e];if(e instanceof Array)return e;var r=e.split(",");return r.reduce(function(e,r){return e.concat(t._parseLevelString(r)).reduce(function(e,t){return e.indexOf(t)<0&&e.push(t),e},[])},[]).sort(function(e,t){return e-t})},e.prototype._parseLevelString=function(e){if(-1===e.indexOf("-"))return[Number(e)];var t=e.split("-");if(2!==t.length)throw"Invalid level request string";var r=Number(t[0]),i=Number(t[1]);if(r>i)throw"Invalid level request string";for(var n=[];i>=r;)n.push(r++);return n},e.prototype._findUncachedLevels=function(e,t){var r=[];e||(e={});for(var i=0;i<t.length;i++){var n=t[i];(!e[n]||e[n]&&!this._isValid(e[n]))&&r.push(n)}return r},e.prototype._sortToLevels=function(e){var t={};return e.forEach(function(e){t[e.level]||(t[e.level]={lastUpdated:null,data:[]}),t[e.level].data.push(e)}),t},e.prototype._cacheToLevels=function(e,t){for(var r in t)e[r]=t[r],e[r].lastUpdated=this._getTime();return e},e.prototype._pickCacheLevels=function(e,t){return t.reduce(function(t,r){return e[r]&&e[r].data?t.concat(e[r].data):t},[])},e.prototype._setCacheItem=function(e,t){t.requestedInformation&&(e.data=t.requestedInformation,e.lastUpdated=this._getTime()),t.userInformation&&(this._userInformation={data:t.userInformation,lastUpdated:this._getTime()}),this._persistLocalStorage()},e.prototype._loadLocalStorage=function(){if(window.localStorage.getItem(this._apiKey))for(var e=JSON.parse(window.localStorage.getItem(this._apiKey)),t=0,r=this._storageKeys;t<r.length;t++){var i=r[t];this[i]=e[i]}},e.prototype._persistLocalStorage=function(){for(var e={},t=0,r=this._storageKeys;t<r.length;t++){var i=r[t];this[i]&&(e[i]=this[i])}window.localStorage.setItem(this._apiKey,JSON.stringify(e))},e.prototype._clearLocalStorage=function(){window.localStorage[this._apiKey]=null},e.prototype._isValid=function(e){if(!e)return!1;if(!e.lastUpdated)return!1;var t=this._getTime(),r=e.lastUpdated+this._expiryTime;return r>t},e.prototype._getTime=function(){return(new Date).getTime()/1e3},e}();r.WkApi=n},{"./fetcher":1}],5:[function(e,t,r){(function(t){var r=e("./wkapi");t.WkApi=r.WkApi}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./wkapi":4}]},{},[5]);