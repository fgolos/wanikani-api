!function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(o)return o(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[a]={exports:{}};e[a][0].call(l.exports,function(t){var r=e[a][1][t];return n(r?r:t)},l,l.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(t,e,r){var i=t("./util/jsonp"),n=function(){function t(t){this._apiKey=t,this.API_BASE="https://www.wanikani.com/api/v1.3/user/"}return t.prototype.getData=function(t,e){return i.jsonp(this.constructUrl(t,e))},t.prototype.constructUrl=function(t,e){var r=this.API_BASE+this._apiKey+"/"+t+"/";return e&&(r+=e+"/"),r},t}();r.Fetcher=n},{"./util/jsonp":2}],2:[function(t,e,r){var i=t("./objectConvert");r.jsonp=function(t){if(!window.Promise)throw"Promise not available. Please apply a polyfill.";var e=function(t,e){var r=document.createElement("script");return r.src=t+(t.indexOf("?")>=0?"&":"?")+"callback="+e,r};return new Promise(function(r,n){var o="jsonp_callback_"+Math.round(1e5*Math.random()),a=e(t,o);a.onerror=n,document.body.appendChild(a),window[o]=function(t){t.error?n(t.error):r(i.convertCase(t)),window[o]=null,delete window[o],document.body.removeChild(a)}})}},{"./objectConvert":3}],3:[function(t,e,r){r.convertCase=function(t){if(!t||"object"!=typeof t)return t;if(t instanceof Array)return t.map(function(t){return r.convertCase(t)});var e={};return Object.keys(t).forEach(function(i){var n=i.replace(/\_(.)/gim,function(t){return t[1].toUpperCase()});e[n]=r.convertCase(t[i])}),e}},{}],4:[function(t,e,r){var i=t("./fetcher"),n=function(){function t(t){if(this._apiKey=t,this._expiryTime=3600,this._lastCriticalRate=0,this._userInformation={},this._studyQueue={},this._levelProgress={},this._srsDistribution={},this._recentUnlocks={},this._criticalItems={},this._radicals={},this._storageKeys=["_userInformation","_studyQueue","_levelProgress","_srsDistribution","_recentUnlocks","_criticalItems","_lastCriticalRate","_radicals"],32!==t.length||!t.match(/[A-z0-9]{32}/))throw"Invalid API Key. API Key must be 32 alphanumeric characters in length.";this._fetcher=new i.Fetcher(t),window.localStorage&&this._loadLocalStorage()}return t.prototype.getUserInformation=function(){var t=this;return this._isValid(this._userInformation)?Promise.resolve(this._userInformation.data):new Promise(function(e,r){var i=t._fetcher.getData("user-information");i.then(function(r){t._setCacheItem(t._userInformation,r),e(r.userInformation)})["catch"](r)})},t.prototype.getStudyQueue=function(){var t=this;return this._isValid(this._studyQueue)?Promise.resolve(this._studyQueue.data):new Promise(function(e,r){var i=t._fetcher.getData("study-queue");i.then(function(r){t._setCacheItem(t._studyQueue,r),e(r.requestedInformation)})["catch"](r)})},t.prototype.getLevelProgression=function(){var t=this;return this._isValid(this._levelProgress)?Promise.resolve(this._levelProgress.data):new Promise(function(e,r){var i=t._fetcher.getData("level-progression");i.then(function(r){t._setCacheItem(t._levelProgress,r),e(r.requestedInformation)})["catch"](r)})},t.prototype.getSrsDistribution=function(){var t=this;return this._isValid(this._srsDistribution)?Promise.resolve(this._srsDistribution.data):new Promise(function(e,r){var i=t._fetcher.getData("srs-distribution");i.then(function(r){t._setCacheItem(t._srsDistribution,r),e(r.requestedInformation)})["catch"](r)})},t.prototype.getRecentUnlocks=function(t){var e=this;void 0===t&&(t=10);var r=!1;return this._recentUnlocks.data&&(r=this._recentUnlocks.data.length!=t),this._isValid(this._recentUnlocks)&&!r?Promise.resolve(this._recentUnlocks.data):new Promise(function(r,i){var n=e._fetcher.getData("recent-unlocks",t);n.then(function(t){e._setCacheItem(e._recentUnlocks,t),r(t.requestedInformation)})["catch"](i)})},t.prototype.getCriticalItems=function(t){var e=this;void 0===t&&(t=75);var r=this._lastCriticalRate!=t;return this._isValid(this._criticalItems)&&!r?Promise.resolve(this._criticalItems.data):(this._lastCriticalRate=t,new Promise(function(r,i){var n=e._fetcher.getData("critical-items",t);n.then(function(t){e._setCacheItem(e._criticalItems,t),r(t.requestedInformation)})["catch"](i)}))},t.prototype.getRadicals=function(t){var e=this;this._radicals||(this._radicals={});var r=this._parseLevelRequest(t),i=this._findUncachedLevels(this._radicals,r),n=function(){return r.reduce(function(t,r){return e._radicals[r]?t.concat(e._radicals[r].data):t},[])};return 0==i.length?Promise.resolve(n()):new Promise(function(t,r){var o=e._fetcher.getData("radicals",i.join(","));o.then(function(r){var i=e._sortToLevels(r.requestedInformation);for(var o in i)e._radicals[o]=i[o],e._radicals[o].lastUpdated=e._getTime();e._setCacheItem(e._userInformation,r),t(n())})})},t.prototype.setExpiry=function(t){this._expiryTime=t},t.prototype._parseLevelRequest=function(t){var e=this;if("number"==typeof t)return[t];if(t instanceof Array)return t;var r=t.split(",");return r.reduce(function(t,r){return t.concat(e._parseLevelString(r)).reduce(function(t,e){return t.indexOf(e)<0&&t.push(e),t},[])},[]).sort(function(t,e){return t-e})},t.prototype._parseLevelString=function(t){if(-1===t.indexOf("-"))return[Number(t)];var e=t.split("-");if(2!==e.length)throw"Invalid level request string";var r=Number(e[0]),i=Number(e[1]);if(r>i)throw"Invalid level request string";for(var n=[];i>=r;)n.push(r++);return n},t.prototype._findUncachedLevels=function(t,e){var r=[];t||(t={});for(var i=0;i<e.length;i++){var n=e[i];(!t[n]||t[n]&&!this._isValid(t[n]))&&r.push(n)}return r},t.prototype._sortToLevels=function(t){var e={};return t.forEach(function(t){e[t.level]||(e[t.level]={lastUpdated:null,data:[]}),e[t.level].data.push(t)}),e},t.prototype._setCacheItem=function(t,e){e.requestedInformation&&(t.data=e.requestedInformation,t.lastUpdated=this._getTime()),e.userInformation&&(this._userInformation={data:e.userInformation,lastUpdated:this._getTime()}),this._persistLocalStorage()},t.prototype._loadLocalStorage=function(){if(window.localStorage.getItem(this._apiKey))for(var t=JSON.parse(window.localStorage.getItem(this._apiKey)),e=0,r=this._storageKeys;e<r.length;e++){var i=r[e];this[i]=t[i]}},t.prototype._persistLocalStorage=function(){for(var t={},e=0,r=this._storageKeys;e<r.length;e++){var i=r[e];this[i]&&(t[i]=this[i])}window.localStorage.setItem(this._apiKey,JSON.stringify(t))},t.prototype._clearLocalStorage=function(){window.localStorage[this._apiKey]=null},t.prototype._isValid=function(t){if(!t)return!1;if(!t.lastUpdated)return!1;var e=this._getTime(),r=t.lastUpdated+this._expiryTime;return r>e},t.prototype._getTime=function(){return(new Date).getTime()/1e3},t}();r.WkApi=n},{"./fetcher":1}],5:[function(t,e,r){(function(e){var r=t("./wkapi");e.WkApi=r.WkApi}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./wkapi":4}]},{},[5]);