!function e(t,r,i){function n(o,a){if(!r[o]){if(!t[o]){var c="function"==typeof require&&require;if(!a&&c)return c(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var l=r[o]={exports:{}};t[o][0].call(l.exports,function(e){var r=t[o][1][e];return n(r?r:e)},l,l.exports,e,t,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(e,t,r){(function(t){var r=e("./wkapi");t.WkApi=r.WkApi}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./wkapi":5}],2:[function(e,t,r){var i=e("./util/jsonp"),n=function(){function e(e){this._apiKey=e,this.API_BASE="https://www.wanikani.com/api/v1.3/user/"}return e.prototype.getData=function(e,t){return i.jsonp(this.constructUrl(e,t))},e.prototype.constructUrl=function(e,t){var r=this.API_BASE+this._apiKey+"/"+e+"/";return t&&(r+=t+"/"),r},e}();r.Fetcher=n},{"./util/jsonp":3}],3:[function(e,t,r){var i=e("./objectConvert");r.jsonp=function(e){if(!window.Promise)throw"Promise not available. Please apply a polyfill.";var t=function(e,t){var r=document.createElement("script");return r.src=e+(e.indexOf("?")>=0?"&":"?")+"callback="+t,r};return new Promise(function(r,n){var s="jsonp_callback_"+Math.round(1e5*Math.random()),o=t(e,s);o.onerror=n,document.body.appendChild(o),window[s]=function(e){e.error?n(e.error):r(i.convertCase(e)),window[s]=null,delete window[s],document.body.removeChild(o)}})}},{"./objectConvert":4}],4:[function(e,t,r){r.convertCase=function(e){if(!e||"object"!=typeof e)return e;if(e instanceof Array)return e.map(function(e){return r.convertCase(e)});var t={};return Object.keys(e).forEach(function(i){var n=i.replace(/\_(.)/gim,function(e){return e[1].toUpperCase()});t[n]=r.convertCase(e[i])}),t}},{}],5:[function(e,t,r){var i=e("./fetcher"),n=function(){function e(e){if(this._apiKey=e,this._expiryTime=3600,this._levelsPerRequest=20,this._lastCriticalRate=0,this._userInformation={},this._studyQueue={},this._levelProgress={},this._srsDistribution={},this._recentUnlocks={},this._criticalItems={},this._radicals={},this._kanji={},this._vocab={},this._storageKeys=["_userInformation","_studyQueue","_levelProgress","_srsDistribution","_recentUnlocks","_criticalItems","_lastCriticalRate","_radicals","_kanji","_vocab"],32!==e.length||!e.match(/[A-z0-9]{32}/))throw"Invalid API Key. API Key must be 32 alphanumeric characters in length.";this._fetcher=new i.Fetcher(e),window.localStorage&&this._loadLocalStorage()}return e.prototype.getUserInformation=function(){var e=this;return this._isValid(this._userInformation)?Promise.resolve(this._userInformation.data):this._fetcher.getData("user-information").then(function(t){return e._setCacheItem(e._userInformation,t)})},e.prototype.getStudyQueue=function(){var e=this;return this._isValid(this._studyQueue)?Promise.resolve(this._studyQueue.data):this._fetcher.getData("study-queue").then(function(t){return e._setCacheItem(e._studyQueue,t)})},e.prototype.getLevelProgression=function(){var e=this;return this._isValid(this._levelProgress)?Promise.resolve(this._levelProgress.data):this._fetcher.getData("level-progression").then(function(t){return e._setCacheItem(e._levelProgress,t)})},e.prototype.getSrsDistribution=function(){var e=this;return this._isValid(this._srsDistribution)?Promise.resolve(this._srsDistribution.data):this._fetcher.getData("srs-distribution").then(function(t){return e._setCacheItem(e._srsDistribution,t)})},e.prototype.getRecentUnlocks=function(e){var t=this;void 0===e&&(e=10);var r=this._recentUnlocks.data&&this._recentUnlocks.data.length!=e;return this._isValid(this._recentUnlocks)&&!r?Promise.resolve(this._recentUnlocks.data):this._fetcher.getData("recent-unlocks",e).then(function(e){return t._setCacheItem(t._recentUnlocks,e)})},e.prototype.getCriticalItems=function(e){var t=this;void 0===e&&(e=75);var r=this._lastCriticalRate!=e;return this._isValid(this._criticalItems)&&!r?Promise.resolve(this._criticalItems.data):(this._lastCriticalRate=e,this._fetcher.getData("critical-items",e).then(function(e){return t._setCacheItem(t._criticalItems,e)}))},e.prototype.getRadicals=function(e){var t=this;this._radicals||(this._radicals={});var r=this._parseLevelRequest(e),i=this._findUncachedLevels(this._radicals,r);return 0==i.length?Promise.resolve(this._pickCacheLevels(this._radicals,r)):this._fetcher.getData("radicals",i.join(",")).then(function(e){var i=t._sortToLevels(e.requestedInformation);return t._cacheToLevels(t._radicals,i),t._setCacheItem(null,e),t._pickCacheLevels(t._radicals,r)})},e.prototype.getKanji=function(e){var t=this;this._kanji||(this._kanji={});var r=this._parseLevelRequest(e),i=this._findUncachedLevels(this._kanji,r);if(0==i.length)return Promise.resolve(this._pickCacheLevels(this._kanji,r));for(var n=[];i.length>0;)n.push(this._fetcher.getData("kanji",i.splice(0,this._levelsPerRequest).join(",")));return Promise.all(n).then(function(e){var i=t._sortToLevels(e.reduce(function(e,t){return e.concat(t.requestedInformation)},[]));return t._cacheToLevels(t._kanji,i),t._setCacheItem(null,e[0]),t._pickCacheLevels(t._kanji,r)})},e.prototype.getVocabulary=function(e){var t=this;this._vocab||(this._vocab={});var r=this._parseLevelRequest(e),i=this._findUncachedLevels(this._vocab,r);if(0==i.length)return Promise.resolve(this._pickCacheLevels(this._vocab,r));for(var n=[];i.length>0;)n.push(this._fetcher.getData("vocabulary",i.splice(0,this._levelsPerRequest).join(",")));return Promise.all(n).then(function(e){var i=t._sortToLevels(e.reduce(function(e,t){return e.concat(t.requestedInformation)},[]));return t._cacheToLevels(t._vocab,i),t._setCacheItem(null,e[0]),t._pickCacheLevels(t._vocab,r)})},e.prototype.setExpiry=function(e){this._expiryTime=e},e.prototype.setLevelsPerRequest=function(e){this._levelsPerRequest=e},e.prototype._parseLevelRequest=function(e){var t=this;if("number"==typeof e)return[e];if(e instanceof Array)return e;var r=e.split(",");return r.map(function(e){return t._parseLevelString(e)}).reduce(function(e,t){return e.concat(t)}).filter(function(e,t,r){return r.indexOf(e)==t}).sort(function(e,t){return e-t})},e.prototype._parseLevelString=function(e){if(-1===e.indexOf("-"))return[Number(e)];var t=e.split("-");if(2!==t.length)throw"Invalid level request string";var r=Number(t[0]),i=Number(t[1]);if(r>i)throw"Invalid level request string";return Array.apply(0,Array(i-r+1)).map(function(e,t){return r+t})},e.prototype._findUncachedLevels=function(e,t){var r=this;return t.filter(function(t){return!e[t]||e[t]&&!r._isValid(e[t])})},e.prototype._sortToLevels=function(e){var t={};return e.forEach(function(e){t[e.level]||(t[e.level]={lastUpdated:null,data:[]}),t[e.level].data.push(e)}),t},e.prototype._cacheToLevels=function(e,t){var r=this;return Object.keys(t).forEach(function(i){e[i]=t[i],e[i].lastUpdated=r._getTime()}),e},e.prototype._pickCacheLevels=function(e,t){return t.reduce(function(t,r){return e[r]&&e[r].data?t.concat(e[r].data):t},[])},e.prototype._setCacheItem=function(e,t){var r;return t.requestedInformation&&e&&(e.data=t.requestedInformation,e.lastUpdated=this._getTime(),r=t.requestedInformation),t.userInformation&&(this._userInformation={data:t.userInformation,lastUpdated:this._getTime()},r||(r=t.userInformation)),this._persistLocalStorage(),r},e.prototype._loadLocalStorage=function(){if(window.localStorage.getItem(this._apiKey))for(var e=JSON.parse(window.localStorage.getItem(this._apiKey)),t=0,r=this._storageKeys;t<r.length;t++){var i=r[t];this[i]=e[i]}},e.prototype._persistLocalStorage=function(){for(var e={},t=0,r=this._storageKeys;t<r.length;t++){var i=r[t];this[i]&&(e[i]=this[i])}window.localStorage.setItem(this._apiKey,JSON.stringify(e))},e.prototype._clearLocalStorage=function(){window.localStorage[this._apiKey]=null},e.prototype._isValid=function(e){if(!e)return!1;if(!e.lastUpdated)return!1;var t=this._getTime(),r=e.lastUpdated+this._expiryTime;return r>t},e.prototype._getTime=function(){return(new Date).getTime()/1e3},e}();r.WkApi=n},{"./fetcher":2}]},{},[1]);